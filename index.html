<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>API Test</title>
</head>

<body style="font-family: Arial; padding: 30px;">

<h2>Cloudflare API Test</h2>

<button onclick="testAPI()">Load Assigned Count</button>

<h3 id="result">Result will show here…</h3>

<script>
const API = "https://salesdashboard.ashishoct34.workers.dev/";

async function testAPI() {
  document.getElementById("result").textContent = "Loading…";

  try {
    const res = await fetch(API);
    const json = await res.json();

    let count = 0;

    // Combine all rows from Sweta + Anusha + Kumkum
    Object.values(json.data).forEach(arr => {
      arr.forEach(r => {
        if (r["assigned date"] || r["assigned date"] === "") {
          // Any row that has Assigned Date column should be counted
          const d = r["assigned date"];
          if (d && d.trim() !== "") count++;
        }
      });
    });

    document.getElementById("result").textContent =
      "ASSIGNED COUNT = " + count;

  } catch (e) {
    document.getElementById("result").textContent = "ERROR: " + e.message;
  }
}
</script>

</body>
</html>
